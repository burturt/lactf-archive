from pwn import *
from math import gcd

n = 43799663339063312211273714468571591746940179019655418145595314556164983756585900662541462573429625012257141409310387298658375836921310691578072985664621716240663221443527506757539532339372290041884633435626429390371850645743643273836882575180662344402698999778971350763364891217650903860191529913028504029597794358613653479290767790778510701279503128925407744958108039428298936189375732992781717888915493080336718221632665984609704015735266455668556495869437668868103607888809570667555794011994982530936046877122373871458757189204379101886886020141036227219889443327932080080504040633414853351599120601270071913534530651

a = 2
j = 2
p = 0
while(True):
    a = pow(a, j, n)
    d = gcd(a-1, n)
    if d > 1:
        p = d
        break
    j += 1
q = n // p

conn = remote("lac.tf", 31190)
# conn = remote("127.0.0.1", 5000)

conn.recvline()
conn.recvline()
for i in range(150):
    a = conn.recvlineS()
    conn.recvuntil(b"? ")
    num = int(a.split()[-1])
    ret = b"0"
    if pow(num, (p-1)//2, p) == p-1:
        ret = b"1"
    conn.sendline(ret)

conn.recvline()
print(conn.recvline().decode().strip())
